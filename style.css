/* ==========================================================================
   SOLO CLINIC HIMS â€” MASTER VISUAL SYSTEM (ENTERPRISE EDITION)
   v6.0.0 | "GOD MODE" ARCHITECTURE
   ==========================================================================
   
   PROJECT:        Solo Clinic HIMS (Health Information Management System)
   MODULE:         Global Stylesheet (CSS3)
   AUTHOR:         Gemini AI System Architect
   DATE:           December 25, 2025
   LICENSE:        Proprietary / Enterprise Edition
   
   DESCRIPTION:
   This stylesheet serves as the single source of truth for the visual 
   presentation of the Solo Clinic application. It implements a custom
   design system based on medical-grade clarity, high-contrast accessibility,
   and "Cockpit" style efficiency for rapid clinical data entry.

   --------------------------------------------------------------------------
   TABLE OF CONTENTS:
   --------------------------------------------------------------------------
   1.0  DESIGN TOKENS (ROOT VARIABLES)
        1.1  Color Palette (Brand, Neutrals, Semantics)
        1.2  Typography Scale & Weights
        1.3  Spacing, Layout, & Metrics
        1.4  Elevation, Shadows, & Depth
        1.5  Z-Index Hierarchy
        1.6  Animation Timing & Easings
   
   2.0  RESET & NORMALIZATION
        2.1  Box Sizing Model
        2.2  Typography Reset
        2.3  Form Element Standardization
   
   3.0  CORE LAYOUT ENGINE
        3.1  Application Root & Viewport
        3.2  Main CSS Grid Architecture
        3.3  Responsive Breakpoints & Adaptability
   
   4.0  COMPONENT: TOP NAVIGATION BAR
        4.1  Brand Identity & Logo
        4.2  Global Search Module
        4.3  Live Clock & Date Widget
        4.4  Action Buttons & Toolbar
   
   5.0  COMPONENT: PATIENT CONTEXT STRIP
        5.1  Sticky Positioning Behavior
        5.2  Patient Avatar, Name, & Meta Data
        5.3  Status Indicators & Badges
   
   6.0  COMPONENT: PANELS, CARDS & CONTAINERS
        6.1  Base Panel Architecture
        6.2  Panel Headers & Typography
        6.3  Content Areas, Scrolling, & Overflow
   
   7.0  COMPONENT: TABBED INTERFACE SYSTEM
        7.1  Tab Navigation Row
        7.2  Interactive States (Hover, Active, Focus)
        7.3  Content Panes & Transitions
   
   8.0  COMPONENT: CLINICAL INPUTS ("GOD MODE")
        8.1  Smart Input Wrappers
        8.2  Voice Dictation Controls (Microphone)
        8.3  Clinical Macros (Quick Chips/Tags)
        8.4  Textarea, Input, & Form Styling
   
   9.0  COMPONENT: RX ENGINE ("COCKPIT" EDITION)
        9.1  Master Tab Layout
        9.2  Safety & Allergy Banners
        9.3  Input Deck & Autocomplete
        9.4  Prescription Ledger (Table)
        9.5  Quick Chips & Duration Controls
   
   10.0 COMPONENT: PREVIEW & PAPER GENERATION
        10.1 Preview Container & Background
        10.2 A4 Paper Physics & Dimensions
        10.3 Vyron Grid System for Printing
        10.4 Letterhead & Footer Graphics
   
   11.0 COMPONENT: MODALS & OVERLAYS
        11.1 Backdrop Filters & Dimming
        11.2 Modal Card Architecture
        11.3 Form Rows, Groups, & Footers
   
   12.0 COMPONENT: HISTORY DRAWER
        12.1 Slide-out Animation Mechanics
        12.2 Timeline Cards & History Items
   
   13.0 DESIGN SYSTEM: INTERACTION & CONTROLS
        13.1 Button Variants (Primary, Success, Dark)
        13.2 Icon Buttons & Ghost Buttons
        13.3 AI Magic Interactions & Loaders
   
   14.0 THEME: DARK MODE ARCHITECTURE
        14.1 Color Overrides & Re-mapping
        14.2 Surface Definition & Depth Adjustment
   
   15.0 ANIMATION KEYFRAMES
        15.1 Fade, Slide, Scale, Rotation, Pulse
   
   16.0 PRINT MEDIA QUERIES (FINAL OUTPUT)
        16.1 UI Suppression
        16.2 Print Layout Enforcement

   17.0 MOBILE ADAPTATION (NEW)
        17.1 Layout Stack & Nav Bar
        17.2 Panel Visibility Logic
   ========================================================================== */


/* ==========================================================================
   1.0 DESIGN TOKENS (ROOT VARIABLES)
   ========================================================================== */

:root {
    /* ----------------------------------------------------------------------
       1.1 COLOR PALETTE
       ---------------------------------------------------------------------- */
    
    /* Brand Colors: Medical Blue Series */
    /* Used for primary actions, active states, and brand identity. */
    --primary-50:   #eff6ff;
    --primary-100:  #dbeafe;
    --primary-200:  #bfdbfe;
    --primary-300:  #93c5fd;
    --primary-400:  #60a5fa;
    --primary-500:  #3b82f6;
    --primary-600:  #2563eb;
    --primary-700:  #1d4ed8;
    --primary-800:  #1e40af;
    --primary-900:  #1e3a8a;
    
    /* Glow effect for primary focus states */
    --primary-glow: rgba(37, 99, 235, 0.35);

    /* Neutral Scale: Clinical Slate Series */
    /* Used for text, backgrounds, borders, and structural elements. */
    --slate-50:     #f8fafc;
    --slate-100:    #f1f5f9;
    --slate-200:    #e2e8f0;
    --slate-300:    #cbd5e1;
    --slate-400:    #94a3b8;
    --slate-500:    #64748b;
    --slate-600:    #475569;
    --slate-700:    #334155;
    --slate-800:    #1e293b;
    --slate-900:    #0f172a;

    /* Semantic States: Success (Green) */
    --color-success-bg:     #ecfdf5;
    --color-success-text:   #059669;
    --color-success-border: #a7f3d0;

    /* Semantic States: Warning (Amber/Orange) */
    --color-warning-bg:     #fffbeb;
    --color-warning-text:   #d97706;
    --color-warning-border: #fde68a;

    /* Semantic States: Danger/Error (Red) */
    --color-danger-bg:      #fef2f2;
    --color-danger-text:    #dc2626;
    --color-danger-border:  #fecaca;

    /* Semantic States: Info (Sky Blue) */
    --color-info-bg:        #f0f9ff;
    --color-info-text:      #0284c7;
    --color-info-border:    #bae6fd;

    /* Rx Badge Colors */
    --badge-tab-bg:         #dbeafe;
    --badge-tab-text:       #1e40af;
    --badge-cap-bg:         #ffedd5;
    --badge-cap-text:       #9a3412;
    --badge-syr-bg:         #fce7f3;
    --badge-syr-text:       #9d174d;
    --badge-inj-bg:         #fee2e2;
    --badge-inj-text:       #991b1b;

    /* ----------------------------------------------------------------------
       1.2 TYPOGRAPHY SCALE
       ---------------------------------------------------------------------- */
    --font-sans:     "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", sans-serif;
    --font-serif:    "Merriweather", "Times New Roman", serif;
    --font-mono:     "JetBrains Mono", "Fira Code", monospace;

    /* Text Colors mapped to Slate scale */
    --text-main:      var(--slate-900);
    --text-secondary: var(--slate-600);
    --text-muted:     var(--slate-400);
    --text-inverse:   #ffffff;

    /* ----------------------------------------------------------------------
       1.3 UI SURFACES & LAYOUT METRICS
       ---------------------------------------------------------------------- */
    --bg-app:        #f0f4f8;   /* Global background */
    --bg-panel:      #ffffff;   /* Card/Panel background */
    --bg-subtle:     #f8fafc;   /* Subtle areas */
    --bg-input:      #fcfcfc;   /* Form inputs */
    --bg-glass:      rgba(255, 255, 255, 0.85); /* Frost effect */
    
    --border-subtle: #e2e8f0;
    --border-medium: #cbd5e1;
    --border-focus:  var(--primary-500);

    --header-height: 64px;
    --strip-height:  68px;

    /* ----------------------------------------------------------------------
       1.4 ELEVATION & SHADOWS
       ---------------------------------------------------------------------- */
    --shadow-xs:     0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-sm:     0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
    --shadow-md:     0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
    --shadow-lg:     0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
    --shadow-xl:     0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
    --shadow-inner:  inset 0 2px 4px 0 rgb(0 0 0 / 0.05);

    /* Border Radius constants */
    --radius-sm:     6px;
    --radius-md:     8px;
    --radius-lg:     12px;
    --radius-xl:     16px;
    --radius-round:  50%;

    /* ----------------------------------------------------------------------
       1.5 Z-INDEX HIERARCHY
       ---------------------------------------------------------------------- */
    --z-negative:   -1;
    --z-base:        1;
    --z-elevated:    10;
    --z-sticky:      100;    /* Headers, Context Strips */
    --z-dropdown:    500;    /* Autocomplete, Menus */
    --z-drawer:      800;    /* History Drawer */
    --z-overlay:     900;    /* Modal Backdrops */
    --z-modal:       9999;   /* Modal Content */
    --z-tooltip:     10000;  /* Toasts, Tooltips */

    /* ----------------------------------------------------------------------
       1.6 ANIMATION TIMING
       ---------------------------------------------------------------------- */
    --ease-out:      cubic-bezier(0.16, 1, 0.3, 1);
    --ease-in-out:   cubic-bezier(0.4, 0, 0.2, 1);
    --duration-fast: 0.15s;
    --duration-norm: 0.25s;
    --duration-slow: 0.5s;
}


/* ==========================================================================
   2.0 RESET & NORMALIZATION
   ========================================================================== */

/* 2.1 Box Sizing Model */
*,
*::before,
*::after {
    box-sizing: border-box;
}

/* 2.2 Global Reset */
html {
    height: 100%;
    width: 100%;
    -webkit-text-size-adjust: 100%;
    scroll-behavior: smooth;
}

body {
    margin: 0;
    padding: 0;
    height: 100%;
    width: 100%;
    overflow: hidden; /* App-like feel, containers scroll internally */
    
    font-family: var(--font-sans);
    font-size: 14px;
    line-height: 1.5;
    color: var(--text-main);
    background-color: var(--bg-app);
    
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    
    transition: background-color var(--duration-norm), color var(--duration-norm);
}

/* Custom Scrollbar Styling (Webkit) */
::-webkit-scrollbar {
    width: 6px;
    height: 6px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: var(--slate-300);
    border-radius: 10px;
}

::-webkit-scrollbar-thumb:hover {
    background: var(--slate-400);
}

/* 2.3 Form Element Reset */
button {
    cursor: pointer;
    user-select: none;
    font-family: inherit;
    border: none;
    background: none;
    padding: 0;
    margin: 0;
}

input,
textarea,
select {
    font-family: inherit;
    outline: none;
    appearance: none;
    margin: 0;
}

a {
    text-decoration: none;
    color: inherit;
    cursor: pointer;
}


/* ==========================================================================
   3.0 CORE LAYOUT ENGINE
   ========================================================================== */

/* 3.1 App Root Container */
.app-root {
    display: flex;
    flex-direction: column;
    height: 100vh;
    width: 100vw;
    position: relative;
    z-index: var(--z-base);
}

/* 3.2 Main CSS Grid Layout */
.main-layout {
    flex: 1;
    display: grid;
    /* Grid Columns: 
       1. Left Sidebar (Snapshot) - Fixed width
       2. Center Workspace (Tabs/Rx) - Flexible
       3. Right Sidebar (Preview) - Fixed width
    */
    grid-template-columns: 280px 1fr 450px; 
    grid-template-rows: 1fr;
    gap: 16px;
    padding: 16px;
    overflow: hidden;
    position: relative;
}

/* 3.3 Responsive Breakpoints */
/* Laptop / Tablet Landscape optimization */
@media (max-width: 1366px) {
    .main-layout {
        grid-template-columns: 260px 1fr 400px;
        gap: 12px;
        padding: 12px;
    }
}


/* ==========================================================================
   4.0 COMPONENT: TOP NAVIGATION BAR
   ========================================================================== */

.top-bar {
    height: var(--header-height);
    background-color: var(--bg-panel);
    border-bottom: 1px solid var(--border-subtle);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 24px;
    box-shadow: var(--shadow-sm);
    z-index: var(--z-sticky);
    position: relative;
    transition: background-color var(--duration-norm);
}

/* Flex groups for alignment */
.top-left,
.top-right,
.top-center {
    display: flex;
    align-items: center;
}

.top-left {
    gap: 24px;
}

.top-right {
    gap: 12px;
}

/* 4.1 Brand Identity */
.clinic-brand {
    display: flex;
    align-items: center;
    gap: 12px;
    user-select: none;
}

.logo-icon {
    font-size: 24px;
    background: var(--primary-50);
    color: var(--primary-600);
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-md);
    border: 1px solid rgba(37, 99, 235, 0.1);
    box-shadow: inset 0 1px 2px rgba(255,255,255,0.5);
}

.brand-text {
    display: flex;
    flex-direction: column;
}

.clinic-name {
    font-weight: 700;
    font-size: 16px;
    line-height: 1.1;
    letter-spacing: -0.01em;
    color: var(--text-main);
}

.doctor-name {
    font-size: 12px;
    color: var(--text-secondary);
    font-weight: 500;
}

/* 4.2 Search Module */
.search-container {
    position: relative;
    width: 320px;
}

.search-wrapper {
    position: relative;
    color: var(--text-muted);
}

.search-icon {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
    font-size: 14px;
    opacity: 0.6;
}

.search-wrapper input {
    width: 100%;
    padding: 9px 12px 9px 36px;
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-md);
    background: var(--slate-50);
    font-size: 13px;
    transition: all var(--duration-fast);
    color: var(--text-main);
}

.search-wrapper input:hover {
    background: white;
    border-color: var(--slate-300);
}

.search-wrapper input:focus {
    background: var(--bg-panel);
    border-color: var(--primary-500);
    box-shadow: 0 0 0 3px var(--primary-100);
}

/* Search Dropdown Results */
.search-results-dropdown {
    position: absolute;
    top: calc(100% + 8px);
    left: 0;
    width: 100%;
    background: var(--bg-panel);
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-md);
    box-shadow: var(--shadow-lg);
    max-height: 400px;
    overflow-y: auto;
    z-index: var(--z-dropdown);
    display: none;
    animation: slideDown var(--duration-fast) ease-out;
}

.search-results-dropdown[aria-hidden="false"] {
    display: block;
}

.search-result-item {
    padding: 12px 16px;
    border-bottom: 1px solid var(--slate-50);
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    transition: background-color var(--duration-fast);
}

.search-result-item:last-child {
    border-bottom: none;
}

.search-result-item:hover {
    background-color: var(--primary-50);
}

.search-result-item b {
    color: var(--text-main);
    font-weight: 600;
}

/* 4.3 Live Clock Widget */
.live-clock-wrapper {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 4px 16px;
    background: var(--slate-50);
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-md);
    min-width: 120px;
    transition: border-color 0.2s;
}

.live-clock-wrapper:hover {
    border-color: var(--primary-200);
    background: white;
}

.clock-time {
    font-family: var(--font-mono);
    font-size: 16px;
    font-weight: 700;
    color: var(--primary-700);
    line-height: 1.1;
}

.clock-date {
    font-size: 10px;
    color: var(--text-muted);
    text-transform: uppercase;
    font-weight: 600;
    letter-spacing: 0.5px;
    margin-top: 2px;
}

/* 4.4 Action Buttons Toolbar Separator */
.separator {
    width: 1px;
    height: 24px;
    background-color: var(--border-subtle);
    margin: 0 8px;
}


/* ==========================================================================
   5.0 COMPONENT: PATIENT CONTEXT STRIP
   ========================================================================== */

/* 5.1 Sticky Behavior */
.patient-context-strip {
    height: var(--strip-height);
    background: var(--bg-glass);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    border-bottom: 1px solid var(--border-subtle);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 24px;
    z-index: 90;
    /* Smooth slide-in/out animation */
    transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

.patient-context-strip.is-hidden {
    transform: translateY(-100%);
    position: absolute;
    width: 100%;
}

.context-left {
    display: flex;
    align-items: center;
    gap: 16px;
}

/* 5.2 Patient Avatar */
.avatar-circle {
    width: 44px;
    height: 44px;
    background: linear-gradient(135deg, var(--primary-600), var(--primary-800));
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    font-size: 18px;
    box-shadow: var(--shadow-md);
    border: 2px solid white;
    flex-shrink: 0;
}

.patient-details {
    display: flex;
    flex-direction: column;
    justify-content: center;
}

.patient-name-row {
    display: flex;
    align-items: center;
    gap: 10px;
}

.patient-details h2 {
    margin: 0;
    font-size: 16px;
    font-weight: 700;
    color: var(--text-main);
}

/* 5.3 Status Indicators */
.status-badge {
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.status-badge.draft {
    background: var(--color-warning-bg);
    color: var(--color-warning-text);
    border: 1px solid var(--color-warning-border);
}

.status-badge.success {
    background: var(--color-success-bg);
    color: var(--color-success-text);
    border: 1px solid var(--color-success-border);
}

.patient-meta {
    display: flex;
    gap: 12px;
    font-size: 12px;
    color: var(--text-secondary);
    margin-top: 2px;
    font-family: var(--font-mono);
}

.meta-tag {
    background: var(--slate-100);
    padding: 0 6px;
    border-radius: 4px;
    color: var(--slate-600);
    border: 1px solid var(--slate-200);
}


/* ==========================================================================
   6.0 COMPONENT: PANELS, CARDS & CONTAINERS
   ========================================================================== */

/* 6.1 Base Panel Architecture */
.panel {
    background: var(--bg-panel);
    border-radius: var(--radius-lg);
    border: 1px solid var(--border-subtle);
    box-shadow: var(--shadow-sm);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    position: relative;
    z-index: 1;
    transition: box-shadow var(--duration-fast), border-color var(--duration-fast);
}

.panel:hover {
    box-shadow: var(--shadow-md);
    border-color: var(--border-medium);
}

/* 6.2 Panel Headers */
.panel-header {
    padding: 12px 16px;
    border-bottom: 1px solid var(--border-subtle);
    background: linear-gradient(to bottom, var(--bg-panel), var(--slate-50));
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.panel-header h3 {
    margin: 0;
    font-size: 12px;
    font-weight: 700;
    color: var(--text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

/* 6.3 Content & Scrolling */
.panel-content {
    padding: 16px;
    flex: 1;
    display: flex;
    flex-direction: column;
}

.scrollable {
    overflow-y: auto;
    flex: 1;
    min-height: 0; /* Flexbox scrolling requirement */
    /* Add padding for scroll content */
    padding-right: 4px;
}

/* Center Panel Specifics (The Workspace) */
.panel-center {
    display: flex;
    flex-direction: column;
}

/* Date Bar within Center Panel */
.visit-date-bar {
    padding: 10px 16px;
    border-bottom: 1px solid var(--border-subtle);
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: var(--slate-50);
}

.visit-date-bar label {
    font-size: 12px;
    font-weight: 600;
    color: var(--text-secondary);
    margin-right: 8px;
}

.visit-date-bar input[type="date"] {
    border: 1px solid var(--border-subtle);
    padding: 5px 10px;
    border-radius: 6px;
    font-weight: 600;
    color: var(--text-main);
    font-family: var(--font-sans);
    background: var(--bg-panel);
    transition: all 0.2s;
}

.visit-date-bar input[type="date"]:hover {
    border-color: var(--primary-300);
}


/* ==========================================================================
   7.0 COMPONENT: TABBED INTERFACE SYSTEM
   ========================================================================== */

/* Container for tabs to fill height */
.clinical-tabs {
    display: flex;
    flex-direction: column;
    flex: 1;
    min-height: 0;
    border-bottom: 1px solid var(--border-subtle);
}

/* 7.1 Tab Navigation Row */
.tab-header-row {
    display: flex;
    border-bottom: 1px solid var(--border-subtle);
    padding: 0 12px;
    background: var(--bg-panel);
    gap: 2px;
}

/* 7.2 Interactive Tab Buttons */
.tab-btn {
    background: transparent;
    border: none;
    padding: 12px 16px;
    font-weight: 500;
    color: var(--text-secondary);
    position: relative;
    transition: all var(--duration-fast);
    font-size: 13px;
    border-bottom: 2px solid transparent;
    margin-bottom: -1px; /* To sit on the border line */
    cursor: pointer;
}

.tab-btn:hover {
    color: var(--primary-600);
    background: var(--slate-50);
    border-radius: 6px 6px 0 0;
}

.tab-btn.active {
    color: var(--primary-700);
    font-weight: 700;
    border-bottom-color: var(--primary-600);
    background: transparent;
}

/* Special Highlight for the Medicines Tab */
.tab-btn[data-tab="tab-rx"].active {
    color: var(--primary-700);
    background: var(--primary-50);
    border-bottom-color: var(--primary-600);
}

/* 7.3 Content Panes */
.tab-body-row {
    flex: 1;
    background: var(--bg-panel);
    position: relative;
    overflow: hidden;
}

.tab-content {
    display: none;
    height: 100%;
    width: 100%;
    position: absolute;
    inset: 0;
    flex-direction: column;
}

.tab-content.active {
    display: flex;
    animation: fadeIn 0.2s ease-in;
}


/* ==========================================================================
   8.0 COMPONENT: CLINICAL INPUTS ("GOD MODE")
   ========================================================================== */

/* 8.1 Smart Wrappers */
.smart-input-wrapper {
    position: relative;
    height: 100%;
    width: 100%;
    display: flex;
    flex-direction: column;
}

/* 8.2 Voice Dictation (Floating Microphone) */
.mic-btn {
    position: absolute;
    bottom: 20px;
    right: 20px;
    width: 44px;
    height: 44px;
    border-radius: 50%;
    background: white;
    border: 1px solid var(--border-subtle);
    box-shadow: var(--shadow-md);
    color: var(--text-secondary);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    transition: all var(--duration-fast);
    z-index: 10;
}

.mic-btn:hover {
    transform: scale(1.1);
    background: var(--primary-50);
    border-color: var(--primary-200);
    color: var(--primary-600);
    box-shadow: var(--shadow-lg);
}

.mic-btn.recording {
    background: var(--color-danger-bg);
    border-color: var(--color-danger-text);
    color: var(--color-danger-text);
    animation: pulse-red 1.5s infinite;
}

/* 8.3 Clinical Macros (Top Bar Chips) */
.macro-bar {
    display: flex;
    gap: 8px;
    padding: 10px 16px;
    background: var(--slate-50);
    border-bottom: 1px solid var(--border-subtle);
    overflow-x: auto;
    white-space: nowrap;
    flex-shrink: 0;
}

/* Hide scrollbar for macros but keep functionality */
.macro-bar::-webkit-scrollbar {
    height: 0;
    width: 0;
}

.macro-btn {
    font-size: 11px;
    padding: 5px 12px;
    border-radius: 16px;
    border: 1px solid var(--slate-300);
    background: white;
    color: var(--slate-600);
    font-weight: 500;
    transition: all 0.2s;
    cursor: pointer;
}

.macro-btn:hover {
    border-color: var(--primary-600);
    color: var(--primary-600);
    background: var(--primary-50);
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
}

/* 8.4 Textarea & Form Styling */
.form-section {
    margin-bottom: 24px;
}

.section-label {
    font-size: 11px;
    font-weight: 700;
    color: var(--primary-600);
    text-transform: uppercase;
    margin-bottom: 8px;
    display: block;
    letter-spacing: 0.5px;
}

/* Vitals Grid System */
.vitals-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
}

.vital-input {
    background: var(--slate-50);
    border: 1px solid var(--border-subtle);
    border-radius: 6px;
    padding: 6px 10px;
    transition: 0.2s;
    position: relative;
}

.vital-input:focus-within {
    background: white;
    border-color: var(--primary-500);
    box-shadow: 0 0 0 2px var(--primary-100);
}

.vital-input label {
    display: block;
    font-size: 10px;
    font-weight: 700;
    color: var(--slate-400);
    text-transform: uppercase;
    margin-bottom: 2px;
}

.vital-input input {
    width: 100%;
    border: none;
    background: transparent;
    padding: 0;
    font-weight: 600;
    color: var(--text-main);
    font-family: var(--font-mono);
    font-size: 14px;
}

/* Main Textareas */
textarea {
    width: 100%;
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-md);
    padding: 12px;
    resize: none;
    background: var(--bg-panel);
    font-size: 13px;
    line-height: 1.6;
    color: var(--text-main);
}

/* Full height textareas inside tabs */
.tab-content textarea {
    border: none;
    border-radius: 0;
    height: 100%;
    padding: 20px;
    font-size: 14px;
}

.tab-content textarea:focus {
    background: var(--slate-50);
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.02);
}

/* Utility Classes for warnings */
.warning-border {
    border-left: 4px solid var(--color-danger-text);
    background: var(--color-danger-bg);
}

.divider {
    border: 0;
    border-top: 1px dashed var(--border-subtle);
    margin: 20px 0;
}


/* ==========================================================================
   9.0 COMPONENT: RX ENGINE ("COCKPIT" EDITION)
   ========================================================================== 
   This section defines the layout for the Medicine Prescribing interface.
   It replaces the old split-pane design with a unified Tab Layout.
*/

/* 9.1 Master Tab Layout Container */
.rx-tab-layout {
    display: flex;
    flex-direction: column;
    height: 100%;
    width: 100%;
    background: var(--slate-50);
    position: relative;
    font-family: var(--font-sans);
}

/* 9.2 Safety & Allergy Banners */
.rx-safety-banner {
    background: #fef2f2;
    border-left: 4px solid #ef4444;
    color: #b91c1c;
    padding: 12px 20px;
    font-size: 12px;
    font-weight: 600;
    display: none; /* Hidden by default, toggled via JS */
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid #fecaca;
    animation: slideDown 0.3s ease-out;
}

.rx-safety-banner.is-visible {
    display: flex;
}

.banner-content {
    display: flex;
    align-items: center;
    gap: 12px;
}

.banner-icon {
    font-size: 20px;
}

.banner-text {
    display: flex;
    flex-direction: column;
}

.banner-title {
    font-size: 11px;
    font-weight: 700;
    color: #b91c1c;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.banner-detail {
    font-size: 13px;
    font-weight: 600;
    color: #7f1d1d;
}

.btn-dismiss-alert {
    background: white;
    border: 1px solid #fca5a5;
    color: #b91c1c;
    border-radius: 4px;
    padding: 3px 10px;
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    transition: all 0.2s;
    cursor: pointer;
}

.btn-dismiss-alert:hover {
    background: #fee2e2;
    border-color: #ef4444;
}

/* 9.3 The "Cockpit" Input Deck */
.rx-input-deck {
    background: white;
    padding: 16px 20px;
    border-bottom: 1px solid var(--border-subtle);
    box-shadow: 0 4px 6px -4px rgba(0,0,0,0.05);
    z-index: 20;
    position: relative;
}

/* Quick Chips (Forms) - New Feature */
.rx-quick-chips-row {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 16px;
    overflow-x: auto;
    padding-bottom: 4px;
}

.chip-label {
    font-size: 11px;
    font-weight: 700;
    color: var(--slate-400);
    text-transform: uppercase;
    margin-right: 4px;
}

.chip-btn {
    font-size: 11px;
    padding: 4px 10px;
    border-radius: 12px;
    border: 1px solid var(--border-subtle);
    background: var(--slate-50);
    color: var(--slate-600);
    cursor: pointer;
    transition: all 0.2s;
    white-space: nowrap;
    font-weight: 500;
}

.chip-btn:hover {
    background: var(--primary-50);
    border-color: var(--primary-200);
    color: var(--primary-600);
    transform: translateY(-1px);
}

/* Grid Rows for Input Organization */
.rx-grid-row {
    display: flex;
    gap: 12px;
    margin-bottom: 12px;
    align-items: flex-end;
}

.rx-grid-row.bottom {
    margin-bottom: 0;
    align-items: stretch;
}

/* Input Group Logic */
.input-group {
    flex: 1;
    display: flex;
    flex-direction: column;
    position: relative;
}

.input-group.drug-group {
    flex: 2.5; /* Allocate more space for medicine name */
}

.input-group.small {
    flex: 0.8; /* Less space for dose/freq/dur */
}

.input-group.full {
    flex: 4; /* Max width for remarks */
}

.input-group label {
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    color: var(--slate-400);
    margin-bottom: 5px;
    letter-spacing: 0.05em;
}

/* Input Wrapper for Icon */
.input-wrapper {
    position: relative;
    width: 100%;
}

.input-icon {
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 14px;
    opacity: 0.4;
    pointer-events: none;
}

.input-group input {
    width: 100%;
    height: 42px; /* Taller inputs for "Cute" look */
    padding: 0 12px;
    border: 1px solid var(--slate-300);
    border-radius: 10px; /* Rounder corners */
    background: var(--slate-50);
    font-size: 14px;
    font-weight: 500;
    color: var(--slate-800);
    transition: all 0.2s;
}

/* Indent for icon inputs */
.drug-group input {
    padding-left: 32px;
}

.input-group input:hover {
    background: white;
    border-color: var(--slate-400);
}

.input-group input:focus {
    background: white;
    border-color: var(--primary-500);
    box-shadow: 0 0 0 3px var(--primary-100);
    outline: none;
}

/* Special High-Vis Styling for Drug Name */
#rxDrugName {
    border-left: 3px solid var(--primary-500);
    font-weight: 600;
}

/* Quick Duration Chips (Bottom Row) */
.quick-duration-bar {
    display: flex;
    gap: 6px;
    margin-top: 6px;
}

.dur-chip {
    font-size: 10px;
    padding: 2px 8px;
    background: var(--slate-100);
    color: var(--slate-500);
    border-radius: 6px;
    cursor: pointer;
    transition: 0.2s;
    border: 1px solid transparent;
}

.dur-chip:hover {
    background: var(--primary-50);
    color: var(--primary-600);
    border-color: var(--primary-200);
}

/* Autocomplete Dropdown List */
.suggestions-dropdown {
    position: absolute;
    top: 100%;
    left: 0;
    width: 100%;
    background: white;
    border: 1px solid var(--border-subtle);
    border-radius: 8px;
    box-shadow: 0 10px 25px -5px rgba(0,0,0,0.15), 0 4px 10px -2px rgba(0,0,0,0.1);
    z-index: 500;
    max-height: 250px;
    overflow-y: auto;
    display: none;
    margin-top: 6px;
    padding: 4px;
}

.suggestions-dropdown[aria-hidden="false"] {
    display: block;
    animation: fadeIn 0.1s ease-out;
}

.suggestions-dropdown .search-result-item {
    padding: 8px 12px;
    border-radius: 4px;
    border: none;
    font-size: 13px;
    color: var(--slate-700);
}

.suggestions-dropdown .search-result-item:hover {
    background: var(--primary-50);
    color: var(--primary-700);
}

/* Action Button Group */
.rx-action-group {
    display: flex;
    align-items: center;
    gap: 12px;
}

.btn-add-rx {
    height: 42px; /* Match input height */
    padding: 0 24px;
    background: var(--slate-800);
    color: white;
    border-radius: 10px;
    font-weight: 600;
    font-size: 13px;
    text-transform: uppercase;
    box-shadow: 0 4px 10px rgba(15, 23, 42, 0.2);
    transition: all 0.2s;
    white-space: nowrap;
    display: flex;
    align-items: center;
    gap: 8px;
}

.btn-add-rx:hover {
    background: black;
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(15, 23, 42, 0.25);
}

.btn-add-rx:active {
    transform: translateY(0);
}

.plus-icon {
    font-size: 18px;
    line-height: 1;
}

/* Editing Badge Indicator */
.editing-badge {
    font-size: 10px;
    background: #fffbeb;
    color: #b45309;
    padding: 4px 10px;
    border-radius: 12px;
    font-weight: 700;
    border: 1px solid #fcd34d;
    text-transform: uppercase;
    animation: pulse-border 2s infinite;
}

.editing-badge.is-hidden {
    display: none;
}


/* 9.4 Prescription Ledger (Cute Table) */
.rx-list-wrapper {
    flex: 1;
    overflow-y: auto;
    background: var(--slate-50);
    position: relative;
    padding: 10px 20px 40px 20px;
}

.cute-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0 8px; /* Spacing between rows */
}

/* Header */
.cute-table thead th {
    font-size: 11px;
    font-weight: 700;
    color: var(--slate-400);
    text-transform: uppercase;
    padding: 0 12px 8px 12px;
    text-align: left;
    letter-spacing: 0.5px;
}

/* Rows (Floating Cards) */
.cute-table tbody tr {
    background: white;
    box-shadow: 0 2px 5px rgba(0,0,0,0.03);
    transition: transform 0.2s, box-shadow 0.2s;
    animation: fadeInRow 0.3s ease-out;
}

.cute-table tbody tr:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.06);
    z-index: 5;
    position: relative;
}

/* Rounded corners for rows */
.cute-table td:first-child {
    border-radius: 10px 0 0 10px;
    border-left: 1px solid transparent;
}

.cute-table td:last-child {
    border-radius: 0 10px 10px 0;
    border-right: 1px solid transparent;
}

.cute-table td {
    padding: 14px 12px;
    font-size: 13px;
    color: var(--slate-700);
    vertical-align: middle;
}

/* Form Badges (New Feature) */
.form-badge {
    display: inline-block;
    padding: 2px 6px;
    border-radius: 6px;
    font-size: 10px;
    font-weight: 700;
    text-transform: uppercase;
    margin-right: 6px;
}

.form-badge.tab { background: var(--badge-tab-bg); color: var(--badge-tab-text); }
.form-badge.cap { background: var(--badge-cap-bg); color: var(--badge-cap-text); }
.form-badge.syr { background: var(--badge-syr-bg); color: var(--badge-syr-text); }
.form-badge.inj { background: var(--badge-inj-bg); color: var(--badge-inj-text); }
.form-badge.def { background: var(--slate-100); color: var(--slate-500); }

.med-name {
    font-weight: 600;
    color: var(--slate-900);
    font-size: 14px;
}

.med-remarks {
    font-size: 12px;
    color: var(--slate-500);
    margin-top: 2px;
    font-style: italic;
    display: flex;
    align-items: center;
    gap: 4px;
}

/* Timing Icons */
.time-badge {
    font-size: 12px;
    display: inline-flex;
    gap: 4px;
    align-items: center;
    color: var(--slate-600);
    font-weight: 500;
}

/* Row Action Buttons */
.btn-row-action {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 1px solid transparent;
    transition: 0.2s;
    color: var(--slate-400);
    cursor: pointer;
}

.btn-row-action:hover {
    background: var(--slate-100);
    color: var(--slate-700);
}

.btn-row-action.delete:hover {
    background: var(--color-danger-bg);
    color: var(--color-danger-text);
    border-color: var(--color-danger-border);
}

/* Empty State Illustration */
.rx-empty {
    margin-top: 60px;
    display: flex;
    flex-direction: column;
    align-items: center;
    opacity: 0.6;
}

.empty-icon {
    font-size: 48px;
    margin-bottom: 10px;
    filter: grayscale(1);
}

.empty-text {
    font-weight: 600;
    color: var(--slate-500);
}

.empty-sub {
    font-size: 12px;
    color: var(--slate-400);
}


/* ==========================================================================
   10.0 COMPONENT: PREVIEW & PAPER GENERATION
   ========================================================================== */

/* 10.1 Preview Wrapper */
.preview-wrapper {
    background: var(--slate-300);
    padding: 24px;
    height: 100%;
    overflow-y: auto;
    display: flex;
    justify-content: center;
    align-items: flex-start; /* Align top */
}

/* 10.2 A4 Paper Physics */
.paper-sheet {
    background: white;
    width: 100%;
    max-width: 210mm; /* A4 Width */
    min-height: 297mm; /* A4 Height */
    box-shadow: var(--shadow-xl);
    padding: 40px;
    font-family: "Times New Roman", Times, serif;
    color: #111;
    display: flex;
    flex-direction: column;
    position: relative;
    transform-origin: top center;
}

/* 10.4 Letterhead Graphics */
.paper-header {
    margin-bottom: 24px;
}

.header-logo-row {
    display: flex;
    align-items: flex-start;
    gap: 20px;
    margin-bottom: 20px;
}

.logo-box {
    width: 80px;
    height: 80px;
    background: var(--primary-50);
    color: var(--primary-600);
    font-size: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 12px;
}

.clinic-info-box {
    flex: 1;
}

.paper-header h1 {
    font-family: var(--font-sans);
    font-size: 28px;
    color: var(--primary-800);
    margin: 0;
    font-weight: 900;
    text-transform: uppercase;
    letter-spacing: 1px;
    line-height: 1.2;
}

.paper-header h2 {
    font-family: var(--font-sans);
    font-size: 16px;
    margin: 4px 0;
    color: #333;
    font-weight: 600;
}

.clinic-addr {
    margin: 4px 0 0 0;
    font-size: 13px;
    color: #666;
    max-width: 300px;
}

.paper-hr-thick {
    height: 4px;
    background: var(--primary-700);
    width: 100%;
}

.paper-hr-thin {
    height: 1px;
    background: #ccc;
    width: 100%;
    margin-bottom: 20px;
}

/* Patient Meta Grid */
.paper-patient-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px 24px;
    font-family: var(--font-sans);
    font-size: 13px;
    margin-bottom: 12px;
    padding: 10px 0;
}

.meta-item {
    display: flex;
}

.meta-item.align-right {
    justify-content: flex-end;
}

.meta-label {
    font-weight: 700;
    color: #555;
    width: 90px;
}

.meta-val {
    font-weight: 500;
    color: #000;
}

/* Paper Body Content */
.paper-body {
    flex: 1;
    font-size: 15px;
    line-height: 1.5;
}

/* Graphic Vitals Box */
.paper-vitals-box {
    border: 1px solid #000;
    padding: 12px;
    margin-bottom: 24px;
    font-family: var(--font-mono);
    font-size: 13px;
    background: #fcfcfc;
    display: flex;
    align-items: center;
}

.vitals-title {
    font-weight: 900;
    margin-right: 12px;
    text-decoration: underline;
}

.vitals-content {
    font-weight: 600;
}

/* Sections */
.paper-section {
    margin-bottom: 18px;
}

.paper-label {
    font-weight: 900;
    text-transform: uppercase;
    font-size: 12px;
    font-family: var(--font-sans);
    color: #444;
    margin-bottom: 4px;
    letter-spacing: 0.5px;
    border-bottom: 1px solid #eee;
    display: inline-block;
}

/* 10.3 Vyron Grid System for Printing */
.rx-section-print {
    margin-top: 32px;
}

.rx-symbol {
    font-size: 42px;
    font-weight: bold;
    margin-bottom: 8px;
    font-family: serif;
    line-height: 1;
    color: #000;
}

.paper-rx-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
    font-family: var(--font-sans);
    font-size: 13px;
}

.paper-rx-table th,
.paper-rx-table td {
    border: 1px solid #000; /* Solid Black Grid for Print */
    padding: 8px;
    text-align: left;
    vertical-align: top;
}

.paper-rx-table th {
    background-color: #f1f1f1;
    font-weight: bold;
    text-transform: uppercase;
    font-size: 11px;
}

/* Specific Column Widths for Print Layout */
.col-type { width: 30px; text-align: center; }
.col-med  { width: 35%; font-weight: bold; }
.col-dose { width: 10%; }
.col-freq { width: 15%; }
.col-dur  { width: 10%; }
.col-remark { width: 25%; font-size: 11px; font-style: italic; }

/* Advice Box */
.advice-box {
    margin-top: 24px;
    border: 1px dashed #999;
    padding: 12px;
    min-height: 80px;
}

/* Paper Footer */
.paper-footer {
    margin-top: 50px;
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    font-family: var(--font-sans);
}

.footer-note {
    font-size: 11px;
    color: #666;
    max-width: 60%;
    font-style: italic;
}

.signature-box {
    width: 200px;
    text-align: center;
}

.sign-img {
    height: 50px;
}

.sign-label {
    border-top: 1px solid #000;
    padding-top: 4px;
    font-size: 12px;
    font-weight: 700;
    text-transform: uppercase;
}


/* ==========================================================================
   11.0 COMPONENT: MODALS & OVERLAYS
   ========================================================================== */

/* 11.1 Backdrop & Overlay */
.modal-overlay {
    position: fixed;
    inset: 0;
    background: rgba(15, 23, 42, 0.7);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    z-index: var(--z-modal);
    display: none;
    align-items: center;
    justify-content: center;
}

.modal-overlay[aria-hidden="false"] {
    display: flex;
    animation: fadeIn 0.2s;
}

/* 11.2 Modal Card Container */
.modal-card {
    background: var(--bg-panel);
    width: 550px;
    border-radius: var(--radius-xl);
    box-shadow: var(--shadow-xl);
    display: flex;
    flex-direction: column;
    animation: scaleUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    max-height: 85vh;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.modal-header {
    padding: 24px;
    border-bottom: 1px solid var(--border-subtle);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-header h2 {
    margin: 0;
    font-size: 20px;
    color: var(--text-main);
}

.modal-body {
    padding: 24px;
    overflow-y: auto;
}

/* 11.3 Form Rows */
.form-row {
    display: flex;
    gap: 16px;
    margin-bottom: 20px;
}

.form-group {
    flex: 1;
}

.form-group.small {
    flex: 0.5;
}

.form-group label {
    display: block;
    font-size: 12px;
    font-weight: 600;
    color: var(--text-secondary);
    margin-bottom: 8px;
}

.form-group input,
.form-group select,
.form-group textarea {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--border-subtle);
    border-radius: var(--radius-md);
    transition: all 0.2s;
    font-size: 14px;
    background: var(--bg-panel);
    color: var(--text-main);
}

.form-group input:focus {
    border-color: var(--primary-500);
    box-shadow: 0 0 0 3px var(--primary-100);
}

.modal-footer {
    padding: 20px 24px;
    border-top: 1px solid var(--border-subtle);
    background: var(--slate-50);
    border-bottom-left-radius: var(--radius-xl);
    border-bottom-right-radius: var(--radius-xl);
    display: flex;
    justify-content: flex-end;
}


/* ==========================================================================
   12.0 COMPONENT: HISTORY DRAWER
   ========================================================================== */

/* 12.1 Slide-out Container */
.drawer-overlay {
    position: fixed;
    inset: 0;
    background: rgba(15, 23, 42, 0.4);
    backdrop-filter: blur(2px);
    z-index: var(--z-drawer);
    display: none;
    justify-content: flex-end;
}

.drawer-overlay[aria-hidden="false"] {
    display: flex;
    animation: fadeIn 0.2s;
}

.drawer-content {
    width: 420px;
    background: var(--bg-panel);
    height: 100%;
    box-shadow: var(--shadow-xl);
    display: flex;
    flex-direction: column;
    animation: slideLeft 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

.drawer-header {
    padding: 20px;
    border-bottom: 1px solid var(--border-subtle);
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: var(--slate-50);
}

.drawer-body-scroll {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
    background: var(--bg-app);
}

/* 12.2 Timeline Cards */
.history-card {
    background: var(--bg-panel);
    border-radius: var(--radius-md);
    border: 1px solid var(--border-subtle);
    padding: 16px;
    margin-bottom: 12px;
    cursor: pointer;
    transition: all 0.2s;
    position: relative;
    border-left: 4px solid var(--slate-300);
    box-shadow: var(--shadow-sm);
}

.history-card:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
    border-left-color: var(--primary-500);
}

.card-date {
    font-size: 12px;
    font-weight: 700;
    color: var(--text-muted);
    margin-bottom: 8px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.card-co {
    font-size: 13px;
    color: var(--text-main);
    line-height: 1.4;
}


/* ==========================================================================
   13.0 DESIGN SYSTEM: INTERACTION & CONTROLS
   ========================================================================== */

/* 13.1 Button Variants */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 8px 16px;
    border-radius: var(--radius-md);
    font-weight: 600;
    font-size: 13px;
    transition: all 0.2s ease;
    white-space: nowrap;
}

.btn:active {
    transform: translateY(1px);
}

/* Primary Button (Blue) */
.btn-primary {
    background: var(--primary-600);
    color: white;
    border: 1px solid transparent;
    box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

.btn-primary:hover {
    background: var(--primary-700);
    box-shadow: 0 4px 6px -1px var(--primary-glow);
}

/* Success Button (Green) */
.btn-success {
    background: var(--color-success-text);
    color: white;
    border: 1px solid transparent;
}

.btn-success:hover {
    background: #047857;
    box-shadow: 0 4px 10px rgba(16, 185, 129, 0.3);
}

/* Dark Button (Slate) */
.btn-dark {
    background: var(--slate-800);
    color: white;
    border: 1px solid transparent;
}

.btn-dark:hover {
    background: var(--slate-900);
}

/* 13.2 Icon & Ghost Buttons */
.btn-icon {
    padding: 8px;
    background: transparent;
    color: var(--text-secondary);
    border: 1px solid transparent;
    border-radius: var(--radius-md);
}

.btn-icon:hover {
    background: var(--slate-100);
    color: var(--primary-600);
}

.btn-ghost {
    background: transparent;
    color: var(--primary-600);
    border: 1px solid transparent;
}

.btn-ghost:hover {
    background: var(--primary-50);
}

.close-btn {
    background: none;
    border: none;
    font-size: 24px;
    color: var(--text-muted);
    line-height: 1;
    cursor: pointer;
}

.close-btn:hover {
    color: var(--color-danger-text);
}

/* 13.3 Magic AI Button */
/* Special style for the AI Suggest feature */
.btn-magic-ghost {
    background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
    border: 1px solid #bae6fd;
    color: var(--primary-700);
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    gap: 6px;
}

.btn-magic-ghost:hover {
    background: white;
    box-shadow: 0 0 15px rgba(56, 189, 248, 0.3);
    border-color: var(--primary-300);
    transform: translateY(-1px);
}

/* AI Loading Spinner */
.ai-loader {
    width: 12px;
    height: 12px;
    border: 2px solid var(--primary-500);
    border-bottom-color: transparent;
    border-radius: 50%;
    display: inline-block;
    animation: rotation 1s linear infinite;
}

.ai-loader.is-hidden {
    display: none;
}


/* ==========================================================================
   14.0 THEME: DARK MODE ARCHITECTURE
   ========================================================================== */

/* 14.1 Color Overrides */
body.dark-mode {
    --bg-app:        #0f172a;
    --bg-panel:      #1e293b;
    --bg-subtle:     #334155;
    --bg-input:      #1e293b;
    --bg-glass:      rgba(30, 41, 59, 0.85);
    
    --text-main:     #f8fafc;
    --text-secondary: #94a3b8;
    --text-muted:    #64748b;
    --text-inverse:  #000000;
    
    --border-subtle: #334155;
    --border-medium: #475569;
    
    --shadow-sm:     0 1px 2px rgba(0,0,0,0.3);
    --shadow-md:     0 4px 6px rgba(0,0,0,0.4);
    --shadow-float:  0 10px 25px rgba(0,0,0,0.5);
    
    --slate-50:      #1e293b;
    --slate-100:     #334155;
    --slate-200:     #475569;
    --slate-300:     #64748b;
}

/* 14.2 Surface Redefinitions */
body.dark-mode .panel-header {
    background: linear-gradient(to bottom, #1e293b, #1e293b);
}

body.dark-mode .tab-btn {
    color: #94a3b8;
}

body.dark-mode .tab-btn.active {
    color: white;
    border-bottom-color: white;
}

body.dark-mode .tab-btn[data-tab="tab-rx"].active {
    background: #1e40af;
    color: white;
}

body.dark-mode .avatar-circle {
    border-color: #334155;
}

body.dark-mode .paper-sheet {
    /* Dim the paper slightly to reduce glare, but keep readable */
    filter: brightness(0.9);
}

/* Macro Bar Dark Mode */
body.dark-mode .macro-bar {
    background: #1e293b;
    border-color: #334155;
}

body.dark-mode .macro-btn {
    background: #334155;
    color: #e2e8f0;
    border-color: #475569;
}

body.dark-mode .macro-btn:hover {
    background: var(--primary-700);
    border-color: var(--primary-600);
}

body.dark-mode .mic-btn {
    background: #334155;
    border-color: #475569;
    color: #94a3b8;
}

body.dark-mode .mic-btn:hover {
    background: var(--primary-900);
    color: white;
}

/* Rx Module Dark Mode Overrides */
body.dark-mode .rx-tab-layout,
body.dark-mode .rx-input-deck,
body.dark-mode .rx-list-wrapper,
body.dark-mode .rx-table thead th {
    background: #1e293b;
    color: #cbd5e1;
    border-color: #334155;
}

body.dark-mode .rx-table tbody tr {
    background: #1e293b;
}

body.dark-mode .rx-table tbody tr:hover {
    background: #334155;
}

body.dark-mode .input-group input {
    background: #334155;
    border-color: #475569;
    color: white;
}

body.dark-mode .suggestions-dropdown {
    background: #1e293b;
    border-color: #475569;
}

body.dark-mode .suggestions-dropdown .search-result-item {
    color: #cbd5e1;
}

body.dark-mode .suggestions-dropdown .search-result-item:hover {
    background: #334155;
}

body.dark-mode .chip-btn {
    background: #334155;
    color: #cbd5e1;
    border-color: #475569;
}

body.dark-mode .chip-btn:hover {
    background: #1e40af;
    color: white;
}

body.dark-mode .dur-chip {
    background: #334155;
    color: #cbd5e1;
}

body.dark-mode .dur-chip:hover {
    background: #1e40af;
}


/* ==========================================================================
   15.0 ANIMATION KEYFRAMES
   ========================================================================== */

/* Fade In */
@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* Slide Down (for Dropdowns/Banners) */
@keyframes slideDown {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Slide Left (for Drawer) */
@keyframes slideLeft {
    from { transform: translateX(100%); }
    to { transform: translateX(0); }
}

/* Scale Up (for Modals) */
@keyframes scaleUp {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
}

/* Rotate (for Loaders) */
@keyframes rotation {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Pulse Red (Recording State) */
@keyframes pulse-red {
    0% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.2); }
    70% { box-shadow: 0 0 0 6px rgba(220, 38, 38, 0); }
    100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0); }
}

/* Pulse Border (Editing State) */
@keyframes pulse-border {
    0% { border-color: rgba(217, 119, 6, 0.3); }
    50% { border-color: rgba(217, 119, 6, 0.8); }
    100% { border-color: rgba(217, 119, 6, 0.3); }
}

@keyframes fadeInRow {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}


/* ==========================================================================
   16.0 PRINT MEDIA QUERIES (Clone Method)
   ========================================================================== */

/* Default: Hide the print clone on screen */
.printable-clone {
    display: none;
}

@media print {
    @page {
        margin: 0;
        size: A4;
    }

    /* 1. Hide the entire App Application */
    .app-root, 
    .modal-overlay, 
    .drawer-overlay, 
    .toast-container {
        display: none !important;
    }

    /* 2. Make the body white and handle backgrounds */
    body {
        background: white !important;
        margin: 0 !important;
        padding: 0 !important;
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        width: 100%;
        height: 100%;
    }

    /* 3. Show ONLY the printable clone */
    .printable-clone {
        display: block !important;
        width: 100% !important;
        height: auto !important;
        position: absolute !important;
        top: 0 !important;
        left: 0 !important;
        z-index: 9999 !important;
        background: white !important;
        font-family: "Inter", sans-serif !important;
    }
    
    /* Ensure table borders print correctly */
    .printable-clone table, 
    .printable-clone th, 
    .printable-clone td {
        border-color: #ddd !important;
    }
}

/* ==========================================================================
   17.0 MOBILE ADAPTATION (RESPONSIVE LAYER)
   ========================================================================== */

@media (max-width: 768px) {
    
    /* --- 1. LAYOUT RESET --- */
    .app-root {
        height: 100vh;
        height: -webkit-fill-available; /* Fix for iOS Safari */
        padding-bottom: 60px; /* Space for bottom nav */
    }

    .main-layout {
        display: block; /* Disable Grid */
        padding: 8px;
        overflow-y: auto;
        height: calc(100vh - 120px);
    }

    /* --- 2. HIDE/SHOW PANELS BASED ON VIEW --- */
    .panel {
        display: none; /* Hidden by default on mobile */
        height: 100%;
        border: none;
        box-shadow: none;
    }

    /* Helper classes toggled by JS */
    .panel.mobile-active {
        display: flex !important;
    }

    /* --- 3. HEADER ADJUSTMENTS --- */
    .top-bar {
        padding: 0 12px;
        height: 56px;
    }

    .brand-text { display: none; } /* Hide text to save space */
    .clinic-brand .logo-icon { margin-right: 0; }
    
    /* Search Bar Compact */
    .search-container {
        width: 140px;
        margin-left: 10px;
    }
    .search-wrapper input {
        padding-left: 30px;
        font-size: 12px;
    }

    /* Hide non-essential header buttons */
    .top-center, 
    #themeToggleBtn, 
    #shortcutsBtn, 
    #printBtn, 
    .separator {
        display: none;
    }

    /* --- 4. PATIENT CONTEXT STRIP --- */
    .patient-context-strip {
        padding: 0 12px;
        height: 60px;
        position: relative;
    }
    .avatar-circle { width: 36px; height: 36px; font-size: 14px; }
    .patient-details h2 { font-size: 14px; }
    .patient-meta { font-size: 10px; }
    .context-right { display: none; } /* Hide History/Calc buttons on strip */

    /* --- 5. EDITOR & TABS --- */
    .clinical-tabs {
        border: none;
    }

    .tab-header-row {
        overflow-x: auto; /* Scrollable tabs */
        white-space: nowrap;
        padding-bottom: 0;
    }

    .tab-btn {
        padding: 10px 12px;
        font-size: 12px;
    }

    /* --- 6. RX COCKPIT MOBILE OPTIMIZATION --- */
    .rx-input-deck {
        padding: 12px;
    }
    
    .rx-grid-row {
        flex-direction: column;
        align-items: stretch;
        gap: 8px;
    }
    
    .rx-grid-row.bottom {
        flex-direction: column;
    }

    .input-group.drug-group, 
    .input-group.small, 
    .input-group.full {
        flex: auto;
        width: 100%;
    }

    /* Transform Table to Cards for Rx List */
    .cute-table, .cute-table tbody, .cute-table tr, .cute-table td {
        display: block;
        width: 100%;
    }
    
    .cute-table thead { display: none; } /* Hide headers */
    
    .cute-table tr {
        margin-bottom: 10px;
        border: 1px solid var(--border-subtle);
        border-radius: 8px;
        padding: 10px;
        position: relative;
    }

    .cute-table td {
        padding: 4px 0;
        text-align: left;
        border: none !important;
    }
    
    .cute-table td:first-child { display: none; } /* Hide Index # */
    
    .cute-table td:last-child {
        position: absolute;
        top: 10px;
        right: 10px;
    }

    /* --- 7. BOTTOM NAVIGATION BAR --- */
    .mobile-nav-bar {
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 60px;
        background: white;
        border-top: 1px solid var(--border-subtle);
        display: flex;
        justify-content: space-around;
        align-items: center;
        z-index: 1000;
        padding-bottom: env(safe-area-inset-bottom);
    }

    .mob-nav-btn {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: var(--text-muted);
        background: transparent;
        width: 100%;
        height: 100%;
    }

    .mob-nav-btn .icon { font-size: 20px; margin-bottom: 2px; }
    .mob-nav-btn .label { font-size: 10px; font-weight: 600; }

    .mob-nav-btn.active {
        color: var(--primary-600);
        background: var(--primary-50);
    }
    
    /* Adjust Preview Panel for Mobile */
    .preview-wrapper {
        padding: 10px;
    }
    .paper-sheet {
        transform: scale(0.9);
        transform-origin: top center;
        width: 100%;
    }
}

/* Hide Mobile Nav on Desktop */
@media (min-width: 769px) {
    .mobile-nav-bar { display: none; }
}